.header-filter
  %form.filter-form
    .pure-u
      #block_log_date_picker.block-log-date-picker
        %i.icon-calendar
        %span
        %i.icon-caret-down
    .pure-u
      .control-group.search-control
        .controls
          %input{type: "text", placeholder: "Search Site", id: "search_site"}
    .pure-u
      .control-group.search-control
        .controls
          %input{type: "text", placeholder: "Search Advertiser", id: "search_advertiser"}
    .pure-u
      .control-group.search-control
        .controls
          %input{type: "text", placeholder: "Search Advertiser Group", id: "search_advertiser_group"}
    .pure-u
      %a.btn#btn_search Search
    .pure-u.pull-right
      %a.btn#btn_export
        %i.icon-download-alt
          Export
%table.admin-block-logs-table
  %thead
    %tr
      %th
        .pure-g.header-container
          .pure-u.title-container
            .title
              Site
          .pure-u
            #site.actions-container
              %i.icon-sort
      %th
        .pure-g.header-container
          .pure-u.title-container
            .title
              Advertiser
          .pure-u
            #advertiser.actions-container
              %i.icon-sort
      %th
        .pure-g.header-container
          .pure-u.title-container
            .title
              Advertiser Group
          .pure-u
            #advertiser_group.actions-container
              %i.icon-sort
      %th
        .pure-g.header-container
          .pure-u.title-container
            .title
              Action
          .pure-u
            #action.actions-container
              %i.icon-sort
      %th
        .pure-g.header-container
          .pure-u.title-container
            .title
              Status
          .pure-u
            #status.actions-container
              %i.icon-sort
      %th
        .pure-g.header-container
          .pure-u.title-container
            .title
              User
          .pure-u
            #user.actions-container
              %i.icon-sort
      %th
        .pure-g.header-container
          .pure-u.title-container
            .title
              Date/Time
          .pure-u
            #created_at.actions-container
              %i.icon-sort-by-attributes-alt
  %tbody{:id => "block_logs"}
    =render "block_log_table" ,:block_logs => @block_logs

.paginator{:id => "paginator"}
  = paginate @block_logs,:remote => :true

:javascript
  $('.actions-container i').click(function(event) {
    var para = {};
    para.sort_column = $(event.target).parent().attr('id');

    var class_name = $(event.target).attr('class');

    if(class_name==='icon-sort' || class_name==='icon-sort-by-attributes-alt') {
      para.sort_direction = 'asc';
      $('.admin-block-logs-table').find('.actions-container i').removeClass('icon-sort-by-attributes icon-sort-by-attributes-alt').addClass('icon-sort');
      $(event.target).removeClass('icon-sort-by-attributes-alt icon-sort').addClass('icon-sort-by-attributes');
    } else if(class_name==='icon-sort-by-attributes') {
      para.sort_direction = 'desc';
      $(event.target).removeClass('icon-sort-by-attributes').addClass('icon-sort-by-attributes-alt');
    }

    var request = $.ajax({url:'/admin/block_logs', data:para, dataType: 'script'});

  });

  $(document).ready(function() {
    ReachUI.SetupGlobalErrorHandler();

    $('body').tooltip({
      selector: '[rel=tooltip]'
    });

    $('#block_log_date_picker span').html(moment().subtract('days', 6).format('YYYY-MM-DD') + ' to ' + moment().format('YYYY-MM-DD'));

     $('#block_log_date_picker').daterangepicker({
      ranges: {
         'Yesterday': [moment().subtract('days', 1), moment().subtract('days', 1)],
         'Last 7 Days': [moment().subtract('days', 6), moment()],
         'Last 30 Days': [moment().subtract('days', 29), moment()],
         'This Month': [moment().startOf('month'), moment().endOf('month')],
         'Last Month': [moment().subtract('month', 1).startOf('month'), moment().subtract('month', 1).endOf('month')]
      },
      format: 'YYYY-MM-DD',
      separator: ' to ',
      startDate: moment().subtract('days', 6),
      endDate: moment(),
      showWeekNumbers: true,
      dateLimit: false,
      locale: {
        clearLabel: 'Close'
      }
      },
      function(start, end) {
        $('#block_log_date_picker span').html(start.format('YYYY-MM-DD') + ' to ' + end.format('YYYY-MM-DD'));
      })
  });