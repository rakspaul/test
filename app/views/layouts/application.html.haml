!!!
%html
  %head
    %meta{:charset => "utf-8"}
    %title= content_for?(:title) ? yield(:title) : "Reach UI"
    %meta{:content => "Collective Reach UI", :name => "description"}
    %meta{:content => "Collective", :name => "author"}
    %link{:rel => "shortcut icon", :href => "#{image_path('collective.png')}", :type => "image/x-icon"}

    = stylesheet_link_tag    "application", :media => "all"
    = stylesheet_link_tag    "//fonts.googleapis.com/css?family=Armata"
    = javascript_include_tag "application"
    = csrf_meta_tags
    = yield(:head)
  %body
    .app_header#app_header
      .navbar
        .navbar-inner
          %a.brand{:href => "#"}
            = image_tag "cm_logo.jpg"

          %ul.nav
            -if !current_user.agency_user? && !domain_desk?
              - ApplicationHelper::APP_NAVIGATION_BAR.each do |key, value|
                %li{:class => ("active" if value[:controllers].include?(controller.class.name))}
                  = link_to key, value[:path]
            -elsif domain_desk?
              - app_navigation_bar_cdesk.each do |key, value|
                %li{:class => ("active" if value[:controllers].include?(controller.class.name))}
                  = link_to key, value[:path]
            -else
              - ApplicationHelper::APP_NAVIGATION_BAR_AGENCY.each do |key, value|
                %li{:class => ("active" if value[:controllers].include?(controller.class.name))}
                  = link_to key, value[:path]

          %ul.nav.pull-right
            %li.user-info
              %span
                = current_network.name
                %br
                = current_user.first_name
                = current_user.last_name
                (
                = current_user.account_login
                )
            %li
              = link_to "Signout", signout_path
    .breadcrumbs#breadcrumbs
      = render_crumbs separator: "&nbsp;&nbsp;/&nbsp;&nbsp;".html_safe , last_crumb_linked: false

    .app_content
      = content_for?(:content) ? yield(:content) : yield

    :javascript
      $(document).ready(function() {
      // If application is loaded in IFrame then hide the header (Flex loads this application in IFrame).
        var isInIFrame = (window.location != window.parent.location) ? true : false;
        if(isInIFrame) {
          $('#app_header').hide();
          $('#breadcrumbs').hide();
        }
      });

      window.current_user_name        = "#{current_user.try(:full_name)}";
      window.current_trafficker_email = "#{@order.try(:io_detail).try(:trafficking_contact).try(:email)}";
      window.current_trafficker_name  = "#{@order.try(:io_detail).try(:trafficking_contact).try(:full_name)}";
      window.current_am_email         = "#{@order.try(:io_detail).try(:account_manager).try(:email)}";
      window.current_am_name          = "#{@order.try(:io_detail).try(:account_manager).try(:full_name)}";
      window.server_time              = "#{Time.current.strftime("%Y-%m-%d %H:%M:%S")}";
      I18n.defaultLocale              = "en";
      I18n.locale                     = "en";
      window.i18n_identifier          = "#{identifier}";
      window.CONVENTION_AGENCY        = "#{convention_agency}";
      window.CONVENTION_MARKETER      = "#{convention_marketer}";
      window.localise                 = function (text) { return I18n.t(text);}
      window.is_marketer              = function () { return i18n_identifier == CONVENTION_MARKETER }
      window.is_agency                = function () { return i18n_identifier == CONVENTION_AGENCY }

