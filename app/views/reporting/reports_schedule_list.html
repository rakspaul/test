
<!-- Message on top , if that is an error message add "red_msg" class to "top_message_box" container -->
<popup-msg ng-show="flashMessage" ng-controller="popUpMsgCtr"
           ng-init="init('flashMessage','reportEditFailed')"></popup-msg>
<!-- End of Message on top , if that is an error message add "red_msg" class to "top_message_box" container -->
<div class="reports-scheduled-list">
    <div class="scheduled-list-header">
        <div class="clearfix" >
            <h2 class="pull-left" ng-bind-html="textConstants.SCHEDULED_REPORTS"/>
          <!--  <a class="btn btn-default pull-right" ng-click="reset_custom_report()" href="/customreport"
               ng-bind-html="textConstants.NEW_REPORT"/> -->
        </div>
    </div>
    <!-- <div class="scheduled-list-nav clearfix">
        <div class="pull-left each-nav active" ng-bind-html="textConstants.REPORTS" />
        <div class="pull-left each-nav" ng-bind-html="textConstants.WF_ARCHIVE" />
    </div> -->
    <div id="searchList">
    <div class="col-md-12 zeroPadding btn_list_filters">
        <div class="btn-group" role="group" aria-label="...">
            <a role="button" class="btn btn-default" ng-click="reset_custom_report()" href="/customreport"><span class="icon-plus"></span><span data-ng-bind="textConstants.CREATE"></span></a>
        </div>
    <!--Search Input-->
        <div class="pull-right">
            <div class="searchInput" style="float:left;">
            <a class="btn btn-default searchInputBtn" ng-click="searchShowInput();filters.searchText=null">
                <span class="icon-search" aria-hidden="true" style="margin: -1px 0 0 0;"></span>
            </a>
            <div class="input-group searchInputForm" >
                <input type="text" class="form-control" name="creativeSearch" ng-model="creativeSearch" ng-keyup="select_filter_option('searchText', creativeSearch)" placeholder="Search Reports By Report Name..">
                <div class="btn btn-default" ng-click="searchHideInput()">
                    <span class="icon-clear" aria-hidden="true"></span>
                </div>
            </div>
            </div>
            <div class="searchInput" style="float:right;">
                <button type="button" class="btn btn-default"
                        data-toggle="collapse" data-target="#schedule_report_filter" style="height:34px;" data-ng-click="clickedOnFilterIcon()"><span class="icon-filter" style="margin: -1px 0 0 0;"></span></button>
                <!-- attribute data-toogle="collapse"  attached to id="toggle-example"-->
            </div>
        </div>
        <div id="schedule_report_filter" class="collapse">
            <div class="container zeroPadding">
                <div class="row zeroPadding">
                   <hr style="margin-top:10px; margin-bottom:10px;">
                    <div class="col-md-2 zeroPadding" style="margin-right: -5px;">
                        <div class="col-md-12 zeroPadding dropdown-workflow">
                            <label  class="col-sm-12 greyTxt miniLabels ng-binding" data-ng-bind="textConstants.REPORT_TYPES"></label>
                            <div class="dropdown">
                                <button style="width:170px;" class="btn btn-default dropdown-toggle" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">
                                    <span class="text" ng-bind="filters.reportType ? filters.reportType : 'All Types'"></span>
                                    <span class="icon-arrow-down"></span>
                                </button>
                                <ul class="dropdown-menu" aria-labelledby="unitcostType" ng-model="adData.unitType"  id="unitcostType" data-toggle="dropdown">
                                    <li ng-repeat="unitType in workflowData.unitTypes track by unitType.id" class="available">
                                        <a ng-click="dropBoxItemSelected(unitType, 'unitType')" data-ng-bind="unitType.name"></a>
                                    </li>
                                    <li style="padding: 5px" data-ng-click="select_filter_option('reportType', 'Once')">Once</li>
                                    <li style="padding: 5px" data-ng-click="select_filter_option('reportType', 'Daily')">Daily</li>
                                    <li style="padding: 5px" data-ng-click="select_filter_option('reportType', 'Weekly')">Weekly</li>
                                    <li style="padding: 5px" data-ng-click="select_filter_option('reportType', 'Monthly')">Monthly</li>
                                    <li style="padding: 5px" data-ng-click="select_filter_option('reportType', 'Saved')">Saved</li>
                                </ul>
                                <input type="hidden" name="unitType" ng-model="adData.unitType.name" ng-update-hidden/>
                            </div>
                        </div>
                    </div>
                    <!-- 1st column md-2 -->
                    <div class="col-md-2" style="margin-right: -5px;">
                        <div class="col-md-12 zeroPadding dropdown-workflow">
                            <label  class="col-sm-12 greyTxt miniLabels ng-binding" data-ng-bind="textConstants.GENERATED"></label>
                            <div class="dropdown">
                                <button style="width:170px;" class="btn btn-default dropdown-toggle" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">
                                    <span class="text">At any time</span>
                                    <span class="icon-arrow-down"></span>
                                </button>
                                <ul class="dropdown-menu" aria-labelledby="unitcostType" ng-model="adData.unitType"  id="unitcostType" data-toggle="dropdown">
                                    <li ng-repeat="unitType in workflowData.unitTypes track by unitType.id" class="available">
                                        <a ng-click="dropBoxItemSelected(unitType, 'unitType')" data-ng-bind="unitType.name"></a>
                                    </li>
                                </ul>
                                <input type="hidden" name="unitType" ng-model="adData.unitType.name" ng-update-hidden/>
                            </div>
                        </div>
                    </div>
                    <!-- Generated Column over -->
                    <div class="col-md-6" style="margin-right: -5px;">
                        <div class="col-md-12 zeroPadding dropdown-workflow">
                            <label  class="col-sm-12 greyTxt miniLabels ng-binding" data-ng-bind="textConstants.DIMENSIONS_FIVE"></label>
                            <div class="dropdown">
                                <button style="width:560px;" class="btn btn-default dropdown-toggle" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">
                                    <span class="text" ng-bind="filters.dimensions ? filters.dimensions : 'All Dimensions'"></span>
                                    <span class="icon-arrow-down"></span>
                                </button>
                                <ul class="dropdown-menu" aria-labelledby="unitcostType" ng-model="adData.unitType"  id="unitcostType" data-toggle="dropdown">
                                    <li ng-repeat="dimension in customeDimension"
                                        id="{{dimension.key}}"
                                        style="padding:5px"
                                        ng-click="select_filter_option('dimensions', dimension.value)"
                                        ng-bind-html="dimension.value">
                                    </li>
                                </ul>
                                <input type="hidden" name="unitType" ng-model="adData.unitType.name" ng-update-hidden/>
                            </div>
                        </div>
                    </div>
                    <div style="margin-top:32px;" class="col-md-1">
                        <a href="" data-toggle="tab" class="btn btn-default ng-binding"
                           ng-click="getScheduledReports()">Apply</a>
                    </div>
                    <div style="margin-top:32px;" class="col-md-1 zeroPadding">
                        <a class="btn btn-default pull-right" role="button" ng-click="clearFilters()">
                            <div style="top:0px !important;" class="glyphicon glyphicon-repeat pull-left" aria-hidden="true"></div>
                            <span style="margin-left:6px;">Clear</span>
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>
    </div>

    <div style="text-align:center;">
        <span class="download-report-load-icon" style="margin:5px 0px;" ng-if="reportDownloadBusy" ng-bind-html="textConstants.DOWNLOADING"/>
    </div>
    <div class="smallSreenScrollContainer">
        <div class="smallSreenScrollDiv">
            <div class="scheduled_list_table smallSreenScrollContent">
                <div class="table-header">
                    <div class="row">
                        <div class="table-th name-col sort-icon-holder">
                            <span ng-click="sortSchdlReport()" ng-bind-html="textConstants.REPORT_NAME"/>
                            <span class="common-sort-icon" ng-class="(sort.descending?'ascending':'descending')"></span>
                        </div>
                        <!--<div class="table-th name-col" ng-bind-html="textConstants.REPORT_NAME" />-->
                        <div class="table-th more-options">&nbsp;</div>
                        <div class="table-th frequency-col" ng-bind-html="textConstants.SCHEDULE_LIST_REPORT_TYPE" />
                        <!--<div class="table-th frequency-col sort-icon-holder">-->
                            <!--<span ng-click="sortSchdlReport()" ng-bind-html="textConstants.WF_FREQUENCY"/>-->
                            <!--<span class="common-sort-icon" ng-class="(sort.descending?'ascending':'descending')" ></span>-->
                        <!--</div>-->
                        <div class="table-th" ng-bind-html="textConstants.COMPLETE_ON"/>
                        <div class="table-th" ng-bind-html="textConstants.SCHEDULE_LIST_DIMENSIONS"/>
                        <div class="table-th" ng-bind-html="textConstants.CREATED_BY"/>

                    </div>
                </div>
                <div class="table-body">

                    <div class="row" ng-repeat="srlist in schdReportList track by $index">
                        <div class="clearfix rowHover"
                             ng-class="{downloaded:((srlist.instances.length >0) && (srlist.instances[0].viewedOn.length > 0))}">
                            <div class="table-td name-col"
                                 ng-class="{'no-instance':srlist.instances.length <= 0}"
                                 title="{{srlist.name}}"
                                 ng-click="open_second_dimension($event,$index);">
                                {{srlist.name}}
                                <span ng-if="srlist.instances.length > 0" ng-bind-html="' ('+srlist.instances.length+')'"></span>
                            </div>
                            <div class="table-td more-options">
                                <div class="dropdown-workflow">
                                    <div class="dropdown hideOption">
                                        <span data-toggle="dropdown">
                                            <div class="option-horizontal">
                                                <span></span><span></span><span></span>
                                            </div>
                                        </span>
                                        <ul class="dropdown-menu">
                                            <!-- <li ng-click="editSchdReport(srlist.reportId)" ng-bind-html="textConstants.EDIT"/>
                                            <li ng-click="copyScheduleRpt(srlist.reportId)" ng-bind-html="textConstants.COPY"/>
                                            <li ng-click="deleteSchdRpt(srlist.reportId)" ng-bind-html="textConstants.DELETE"/> -->
                                            <li ng-click="editSchdReport(srlist.reportId)"
                                                ng-bind-html="textConstants.EDIT"/>
                                            <li ng-click="copyScheduleRpt(srlist.reportId)"
                                                ng-bind-html="textConstants.COPY"/>
                                            <li ng-click="deleteSchdRptInstance(srlist.reportId,srlist.instances[$index].instanceId)"
                                                ng-bind-html="textConstants.DELETE"/>

                                            <li class="headerDownload" ng-click="downloadSchdReport($parent.$index,$index,srlist.instances[$index].instanceId)">
                                                <span class="icon-download zeroPadding"></span>
                                                <span class="greyTxt" style="padding-left: 7px !important;"><a href="">Download</a></span>
                                            </li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                            <div class="table-td frequency-col" ng-bind-html="srlist.frequency"/>
                            <div class="table-td"
                                 ng-bind-html="srlist.instances[0].completedOn === undefined?
                                 'Pending Status':
                                 srlist.instances[0].completedOn | date : 'EEE, MMM d yyyy'">
                            </div>
                            <div class="table-td" ng-bind-html="srlist.dimensions"></div>
                            <div class="table-td" ng-bind-html="srlist.createdBy"></div>

                        </div>
                        <div class="inner-row" ng-if="srlist.instances.length > 0" >
                            <div class="clearfix rowHover"
                                 ng-repeat="inst in srlist.instances | limitTo: scheduleInstCount[$parent.$index] track by $index"
                                 ng-class="{downloaded:inst.viewedOn.length > 0}">
                                <div class="table-td name-col" ng-bind-html="srlist.name"/>
                                <div class="table-td more-options">
                                    <div class="dropdown-workflow">
                                        <div class="dropdown hideOption">
                                        <span data-toggle="dropdown">
                                            <div class="option-horizontal">
                                                <span></span><span></span><span></span>
                                            </div>
                                        </span>
                                            <ul class="dropdown-menu">
                                                <!-- <li ng-click="editSchdReport(srlist.reportId)" ng-bind-html="textConstants.EDIT"/>
                                                <li ng-click="copyScheduleRpt(srlist.reportId)" ng-bind-html="textConstants.COPY"/>
                                                <li ng-click="deleteSchdRpt(srlist.reportId)" ng-bind-html="textConstants.DELETE"/> -->
                                                <li ng-click="downloadSchdReport($parent.$index,$index,srlist.instances[$index].instanceId)"
                                                    ng-bind-html="textConstants.EDIT"/>
                                                <li ng-click="deleteSchdRptInstance(srlist.reportId,srlist.instances[$index].instanceId)"
                                                    ng-bind-html="textConstants.COPY"/>
                                                <li ng-click="archiveSchdRpt(srlist.reportId,srlist.instances[$index].instanceId)"
                                                    ng-bind-html="textConstants.DELETE"/>

                                                <li class="headerDownload">
                                                    <span class="icon-download zeroPadding"></span>
                                                    <span class="greyTxt" style="padding-left: 7px !important;"><a href="">Download</a></span>
                                                </li>
                                            </ul>
                                        </div>
                                    </div>
                                </div>
                                <div class="table-td frequency-col" ng-bind-html="srlist.frequency"/>
                                <div class="table-td" ng-bind-html="inst.completedOn | date : 'EEE, MMM d yyyy'"/>
                                <div class="table-td" ng-bind-html="srlist.dimensions"/>
                                <div class="table-td" ng-bind-html="srlist.createdBy"/>

                            </div>
                            <div class="row view-all-link"
                                 ng-if="(srlist.instances.length > 3) && (scheduleInstCount[$parent.$index] < srlist.instances.length)">
                                <div class="col-md-12 table-td">
                                    <a ng-click="setScheduleInstCount($parent.$index,srlist.instances.length)"
                                       href="javascript:void(0);" ng-bind-html="textConstants.VIEW_ALL_REPORTS"/>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

