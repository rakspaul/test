
<!-- Message on top , if that is an error message add "red_msg" class to "top_message_box" container -->
<div class="top_message_box" ng-class="{'red_msg':flashMessage.isErrorMsg}" ng-show="flashMessage.message">
	<span class="msg_box">
		<span class="msg_icon">x</span>
		<span class="msg_txt" >
      {{flashMessage.message}}
    </span>
    <span class="close_msg_box_holder">
      <span class="close_msg_box" ng-click="close_msg_box($event);">x</span>
    </span>
	</span>
</div>
<!-- End of Message on top , if that is an error message add "red_msg" class to "top_message_box" container -->


<div class="reports-scheduled-list">

  <div class="scheduled-list-header">
    <div class="clearfix" >
      <h2 class="pull-left">{{textConstants.SCHEDULED_REPORTS}}</h2>
      <a class="btn btn-default pull-right" href="/customreport">{{textConstants.NEW_REPORT}}</a>
    </div>
  </div>
  <div class="scheduled-list-nav clearfix">
    <div class="pull-left each-nav active">
      {{textConstants.REPORTS}}
    </div>
    <div class="pull-left each-nav">
      {{textConstants.WF_ARCHIVE}}
    </div>
  </div>
  <div style="text-align:center;">
    <span class="download-report-load-icon" style="margin:5px 0px;" ng-if="reportDownloadBusy">{{textConstants.DOWNLOADING}} </span>
  </div>
  <div class="scheduled_list_table">
    <div class="table-header">
      <div class="row">
        <div class="col-md-4 table-th name-col">
            {{textConstants.REPORT_NAME}}
          </div>
          <div class="col-md-1 table-th frequency-col sort-icon-holder">
            <span ng-click="sortSchdlReport()">{{textConstants.WF_FREQUENCY}}</span>
             <span class="common-sort-icon" ng-class="(sort.descending?'ascending':'descending')" ></span>
          </div>
          <div class="col-md-2 table-th">
            {{textConstants.COMPLETE_ON}}
          </div>
          <div class="col-md-2 table-th">
            {{textConstants.CREATED_BY}}
          </div>
          <div class="col-md-2 table-th">
            {{textConstants.DISTRIBUTED_TO}}
          </div>
          <div class="col-md-1 table-th more-options">
            {{textConstants.ACTIONS}}
          </div>
        </div>
      </div>

    
    <div class="table-body">
      <div class="row "  ng-repeat="srlist in schdReportList track by $index">
        <div class="clearfix" ng-class="{downloaded:((srlist.instances.length >0) && (srlist.instances[0].viewedOn.length > 0))}">
          <div class="col-md-4 table-td name-col" ng-class="{'no-instance':srlist.instances.length <= 1}"  title="{{srlist.name}}" ng-click="open_second_dimension($event,$index);">{{srlist.name}}<span ng-if="srlist.instances.length > 1"> ({{srlist.instances.length}})</span></div>
          <div class="col-md-1 table-td frequency-col">{{srlist.frequency}}</div>
          <div class="col-md-2 table-td">{{srlist.instances[0].completedOn === undefined?"Pending Status":srlist.instances[0].completedOn}}</div>
          <div class="col-md-2 table-td">{{srlist.createdBy}}</div>
          <div class="col-md-2 table-td">{{srlist.distributionList}}</div>
          <div class="col-md-1 table-td more-options">
            <div class="common_dropdown">
              <div class="dropdown">
                      <span data-toggle="dropdown">
                          <div class="option-horizontal">
                            <span></span><span></span><span></span>
                          </div>
                      </span>
                <ul class="dropdown-menu">
                  <li ng-click="editSchdReport(srlist.reportId)">Edit</li>
                  <li ng-click="copyScheduleRpt(srlist.reportId)">Copy</li>
                  <li ng-click="deleteSchdRpt(srlist.reportId)">Delete</li>
                </ul>
              </div>
            </div>
          </div>
        </div>
          <div class="inner-row" ng-if="srlist.instances.length > 1" >
          <div class="row" ng-repeat="inst in srlist.instances | limitTo: scheduleInstCount[$parent.$index] track by $index" ng-class="{downloaded:inst.viewedOn.length > 0}">
            <div class="col-md-4 table-td name-col">{{srlist.name}}</div>
            <div class="col-md-1 table-td frequency-col">{{srlist.frequency}}</div>
            <div class="col-md-2 table-td">{{inst.completedOn}}</div>
            <div class="col-md-2 table-td">{{srlist.createdBy}} </div>
            <div class="col-md-2 table-td">{{srlist.distributionList}}</div>
            <div class="col-md-1 table-td more-options">

              <div class="common_dropdown">
                <div class="dropdown">
                      <span data-toggle="dropdown">
                          <div class="option-horizontal">
                            <span></span><span></span><span></span>
                          </div>
                      </span>
                  <ul class="dropdown-menu">
                    <li ng-click="downloadSchdReport($parent.$index,$index,srlist.instances[$index].instanceId)">Download</li>
                    <li ng-click="deleteSchdRptInstance(srlist.reportId,srlist.instances[$index].instanceId)">Delete</li>
                    <li ng-click="archiveSchdRpt(srlist.reportId,srlist.instances[$index].instanceId)">Archive</li>
                  </ul>
                </div>
              </div>
            </div>
          </div>
          <div class="row view-all-link" ng-if="(srlist.instances.length > 3) && (scheduleInstCount[$parent.$index] < srlist.instances.length) ">
            <div class="col-md-12 table-td">
              <a ng-click="setScheduleInstCount($parent.$index,srlist.instances.length)" href="javascript:void(0);">{{textConstants.VIEW_ALL_REPORTS}}</a>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  </div>
</div>

