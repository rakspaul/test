
<!-- Message on top , if that is an error message add "red_msg" class to "top_message_box" container -->
<popup-msg ng-show="flashMessage" ng-controller="popUpMsgCtr"
           ng-init="init('flashMessage','reportEditFailed')"></popup-msg>
<!-- End of Message on top , if that is an error message add "red_msg" class to "top_message_box" container -->


<div class="reports-scheduled-list">
    <div class="scheduled-list-header">
        <div class="clearfix" >
            <h2 class="pull-left" ng-bind-html="textConstants.SCHEDULED_REPORTS"/>
            <a class="btn btn-default pull-right" href="/customreport" ng-bind-html="textConstants.NEW_REPORT"/>
        </div>
    </div>
    <div class="scheduled-list-nav clearfix">
        <div class="pull-left each-nav active" ng-bind-html="textConstants.REPORTS" />
        <div class="pull-left each-nav" ng-bind-html="textConstants.WF_ARCHIVE" />
    </div>
    <div style="text-align:center;">
        <span class="download-report-load-icon" style="margin:5px 0px;" ng-if="reportDownloadBusy" ng-bind-html="textConstants.DOWNLOADING"/>
    </div>
    <div class="scheduled_list_table">
        <div class="table-header">
            <div class="row">
                <div class="col-md-4 table-th name-col" ng-bind-html="textConstants.REPORT_NAME" />
                <div class="col-md-1 table-th frequency-col sort-icon-holder">
                    <span ng-click="sortSchdlReport()" ng-bind-html="textConstants.WF_FREQUENCY"/>
                    <span class="common-sort-icon" ng-class="(sort.descending?'ascending':'descending')" ></span>
                </div>
                <div class="col-md-2 table-th" ng-bind-html="textConstants.COMPLETE_ON"/>
                <div class="col-md-2 table-th" ng-bind-html="textConstants.CREATED_BY"/>
                <div class="col-md-2 table-th" ng-bind-html="textConstants.DISTRIBUTED_TO"/>
                <div class="col-md-1 table-th more-options" ng-bind-html="textConstants.ACTIONS"/>
            </div>
        </div>
        <div class="table-body">
            <div class="row "  ng-repeat="srlist in schdReportList track by $index">
                <div class="clearfix"
                     ng-class="{downloaded:((srlist.instances.length >0) && (srlist.instances[0].viewedOn.length > 0))}">
                    <div class="col-md-4 table-td name-col"
                         ng-class="{'no-instance':srlist.instances.length <= 1}"
                         title="{{srlist.name}}"
                         ng-click="open_second_dimension($event,$index);">
                        {{srlist.name}}
                        <span ng-if="srlist.instances.length > 1" ng-bind-html="' ('+srlist.instances.length+')'"></span>
                    </div>
                    <div class="col-md-1 table-td frequency-col" ng-bind-html="srlist.frequency"/>
                    <div class="col-md-2 table-td"
                         ng-bind-html="srlist.instances[0].completedOn === undefined?
                         'Pending Status':
                         srlist.instances[0].completedOn | date : 'EEE, MMM d yyyy'">
                    </div>
                    <div class="col-md-2 table-td" ng-bind-html="srlist.createdBy"></div>
                    <div class="col-md-2 table-td" ng-bind-html="srlist.distributionList"></div>
                    <div class="col-md-1 table-td more-options">
                        <div class="common_dropdown">
                            <div class="dropdown">
                                <span data-toggle="dropdown">
                                    <div class="option-horizontal">
                                        <span></span><span></span><span></span>
                                    </div>
                                </span>
                                <ul class="dropdown-menu">
                                    <li ng-click="editSchdReport(srlist.reportId)" ng-bind-html="textConstants.EDIT"/>
                                    <li ng-click="copyScheduleRpt(srlist.reportId)" ng-bind-html="textConstants.COPY"/>
                                    <li ng-click="deleteSchdRpt(srlist.reportId)" ng-bind-html="textConstants.DELETE"/>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="inner-row" ng-if="srlist.instances.length > 1" >
                    <div class="row"
                         ng-repeat="inst in srlist.instances | limitTo: scheduleInstCount[$parent.$index] track by $index"
                         ng-class="{downloaded:inst.viewedOn.length > 0}">
                        <div class="col-md-4 table-td name-col" ng-bind-html="srlist.name"/>
                        <div class="col-md-1 table-td frequency-col" ng-bind-html="srlist.frequency"/>
                        <div class="col-md-2 table-td" ng-bind-html="inst.completedOn | date : 'EEE, MMM d yyyy'"/>
                        <div class="col-md-2 table-td" ng-bind-html="srlist.createdBy"/>
                        <div class="col-md-2 table-td" ng-bind-html="srlist.distributionList"/>
                        <div class="col-md-1 table-td more-options">
                            <div class="common_dropdown">
                                <div class="dropdown">
                                    <span data-toggle="dropdown">
                                        <div class="option-horizontal">
                                            <span></span><span></span><span></span>
                                        </div>
                                    </span>
                                    <ul class="dropdown-menu">
                                        <li ng-click="downloadSchdReport($parent.$index,$index,srlist.instances[$index].instanceId)"
                                            ng-bind-html="textConstants.DOWNLOAD"/>
                                        <li ng-click="deleteSchdRptInstance(srlist.reportId,srlist.instances[$index].instanceId)"
                                            ng-bind-html="textConstants.DELETE"/>
                                        <li ng-click="archiveSchdRpt(srlist.reportId,srlist.instances[$index].instanceId)"
                                            ng-bind-html="textConstants.ARCHIEVE"/>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row view-all-link"
                         ng-if="(srlist.instances.length > 3) && (scheduleInstCount[$parent.$index] < srlist.instances.length)">
                        <div class="col-md-12 table-td">
                            <a ng-click="setScheduleInstCount($parent.$index,srlist.instances.length)"
                               href="javascript:void(0);" ng-bind-html="textConstants.VIEW_ALL_REPORTS"/>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

