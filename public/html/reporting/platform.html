<div class="reports_main_page_holder">
    <div class="common_reports_container platform_reports_container" >
        <div class="clearfix page_top_header">
            <div class="pull-left page_name">
                Platform Report
            </div>
            <div class="pull-right download_report">
                <download-report></download-report>
            </div>
        </div>
        
        <div class="clearfix">
            <filters-header reports="true"></filters-header>
        </div>
       

    <!-- VIDEO MODE SWITCH COMMENTED FOR NOW -->
            <div class="view_mode_switch_container" ng-show="adFormats.videoAds" style="display:none;" ng-class="{'video_mode_on':videoMode}">
                <span>{{textConstants.VIEW_MODE}}</span>
                <span class="video_off_icon active" ng-class="{'active':!videoMode}"></span>
                <span class="video_btn">
                   <!--  <input type="checkbox" class="switch switch-inverse" data-label-on=" " data-label-off=" " ng-model="videoMode" /> -->
                    <switch ng-model="videoMode" ></switch>
                </span>

                <span class="video_on_icon" ng-class="{'active':videoMode}"></span>
            </div>
    <!-- END OF ...VIDEO MODE SWITCH COMMENTED FOR NOW -->

        <div class="common-load-icon_viewability" ng-show="strategyLoading && selectedCampaign.id != -1"></div>
    </div>

    <div class="platform_container" ng-hide="strategyLoading && selectedCampaign.id != -1">
        <div class="no_data_found" ng-if="!strategyFound" ng-bind-html="getMessageForDataNotAvailable(selectedCampaign)"></div>


        <div class="reports_tabs_content_container"  ng-show="strategyFound">
            <div class="reports_tabs_content_container">
                <!-- -------START :  Platform Tabs ------------------------ -->
                <div class="clearfix">
                    <div class="clearfix reports_tabs_holder">
                        <div class="each_tab cost_tab active " id="platform_performance">
                            <div class="each_tab_text">
                                {{textConstants.PERFORMANCE}}
                            </div>
                        </div>
                        <div class="each_tab " id="platform_cost" ng-show="isAgencyCostModelTransparent">
                            <div class="each_tab_text">
                                {{textConstants.COST}}
                            </div>
                        </div>
                        <div class="each_tab cost_tab " id="platform_viewability" ng-hide="usrRole && !usrRole.showquality">
                            <div class="each_tab_text">
                                {{textConstants.QUALITY}}
                            </div>
                        </div>
                        <div class="each_tab margin_tab " id="platform_margin">
                            <div class="each_tab_text">
                                {{textConstants.MARGIN}}
                            </div>
                        </div>

                    </div>
                </div>
                <!-- -------END :  Platform Tabs ------------------------ -->

                <!-- -------START :  Performance Block ------------------------ -->
                <div ng-class="adFormats.videoAds ? 'reports_block quartile_data_platform' : 'reports_block' " id="reports_platform_performance_block">
                    <div class="no_data_found" ng-if="dataNotFoundForPerformance" ng-bind-html="getMessageForDataNotAvailable(selectedCampaign)"></div>
                    <div class="reports_details_outer_container" ng-show="!dataNotFoundForPerformance" ng-class="{vid_none_hdr:adFormats.videoAds == false,vid_show:adFormats.videoAds == true}">
                        <div class="clearfix reports_platform_header" ng-hide="performanceBusy">
                            <performance-header></performance-header>
                        </div>
                        <div class="strategy_total_container">
                            <div class="strategy_total_container_header clearfix">
                                <div class="each_col first_col" ng-hide="performanceBusy">
                                    {{strategyHeading}}:
                                </div>
                                <div class="row_list_holder">
                                    <div class="common-load-icon" ng-show="performanceBusy"></div>
                                    <div class="clearfix each_row_list expandRow" ng-show="!performanceBusy" ng-repeat="platform in platformData | orderBy:sortTypebyPerformance:sortReverse track by $index" ng-include="'performanceTpl'"></div>
                                </div>
                            </div>
                            <div class="all_strategies_holder" ng-show="!performanceBusy">
                                <div class="each_strategy_holder clearfix" ng-repeat="platform in tacticPlatformData | orderBy:sortTypebyPerformance:sortReverse track by $index" ng-if="platform.ad_id">
                                    <div class="linkage_bar"></div>
                                    <div class="each_strategy clearfix">
                                        <div class="each_col first_col">
                                            {{platform.ad_name}}
                                        </div>
                                        <div class="row_list_holder">
                                            <div class="clearfix each_row_list expandRow" ng-include="'performanceTpl'"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- -------END :  Performance Block ------------------------ -->

                <!-- -------START :  Cost Block ----------------------------- -->

                <div class="reports_block" id="reports_platform_cost_block" style="display:none;">
                    <div class="no_data_found" ng-if="dataNotFoundForCost" ng-bind-html="getMessageForDataNotAvailable(selectedCampaign)"></div>
                    <div class="reports_details_outer_container" ng-show="!dataNotFoundForCost" >
                        <div class="clearfix reports_platform_header" ng-hide="costBusy">
                            <cost-header></cost-header>
                        </div>
                        <div class="strategy_total_container ">
                            <div class="strategy_total_container_header clearfix">
                                <div class="each_cost_heading" ng-hide="costBusy">
                                    {{strategyHeading}}:
                                </div>
                                <div class="row_list_holder">
                                    <div class="common-load-icon" ng-show="costBusy"></div>
                                    <div class="clearfix each_row_list expandRow" ng-show="!costBusy" ng-repeat="platform in platformData |
                                    orderBy:sortTypebyCost:sortReverse track by $index" ng-include="'costTpl'"></div>
                                </div>
                            </div>
                            <div class="all_strategies_holder" ng-show="!costBusy">
                                <div class="each_strategy_holder clearfix" ng-repeat="platform in tacticPlatformData | orderBy:sortTypebyCost:sortReverse track by $index" ng-if="platform.ad_id">
                                    <div class="linkage_bar"></div>
                                    <div class="each_strategy clearfix">
                                        <div class="each_col first_col">
                                            {{platform.ad_name}}
                                        </div>
                                        <div class="row_list_holder">
                                            <div class="clearfix each_row_list expandRow" ng-include="'costTpl'"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- -------END :  Cost Block ----------------------------- -->

                <!-- -------START :  Viewablity Block ----------------------------- -->
                <div class="reports_block" id="reports_platform_viewability_block" style="display:none;" ng-class="{'reports_video_mode_viewability_container': adFormats.videoAds && videoMode}">
                    <div class="no_data_found" ng-if="dataNotFoundForViewability" ng-bind-html="getMessageForDataNotAvailable(selectedCampaign)"></div>
                    <div class="reports_details_outer_container" ng-show="!dataNotFoundForViewability">
                        <div class="clearfix reports_platform_header" ng-hide="viewabilityBusy">
                            <viewablity-header></viewablity-header>
                        </div>
                        <div class="strategy_total_container ">
                            <div class="strategy_total_container_header clearfix">
                                <div class="each_col first_col" ng-hide="viewabilityBusy">
                                    {{strategyHeading}}:
                                </div>
                                <div class="row_list_holder">
                                    <div class="common-load-icon" ng-show="viewabilityBusy"></div>
                                    <div ng-show="!viewabilityBusy" ng-if="!adFormats.videoAds ||  !videoMode" class="clearfix each_row_list expandRow" ng-repeat="platform in platformData | orderBy:sortTypebyViewability:sortReverse  track by $index"  ng-include="'viewabilityTpl'"></div>
                                    <div ng-show="!viewabilityBusy" ng-if="adFormats.videoAds && videoMode" class="clearfix each_row_list expandRow" ng-repeat="platform in platformData | orderBy:sortTypebyViewability:sortReverse  track by $index"  ng-include="'videoViewabilityTpl'"></div>
                                </div>

                            </div>
                            <div class="all_strategies_holder" ng-show="!viewabilityBusy">
                                <div class="each_strategy_holder clearfix" ng-repeat="platform in tacticPlatformData | orderBy:sortTypebyViewability:sortReverse track by $index" ng-if="platform.ad_id">
                                    <div class="linkage_bar"></div>
                                    <div class="each_strategy clearfix">
                                        <div class="each_col first_col">
                                            {{platform.ad_name}}
                                        </div>
                                        <div class="row_list_holder">
                                            <div ng-if="!adFormats.videoAds || !videoMode" class="clearfix each_row_list expandRow" ng-include="'viewabilityTpl'"></div>
                                            <div ng-if="adFormats.videoAds && videoMode" class="clearfix each_row_list expandRow" ng-include="'videoViewabilityTpl'"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- -------END :  Viewablity Block ----------------------------- -->

                <!-- -------START :  Margin Block ----------------------------- -->

                    <div class="reports_block" id="reports_platform_margin_block" style="display:none; position:relative; overflow-x:scroll; border:1px solid #F2F2F2">
                    <div class="no_data_found" ng-if="dataNotFoundForMargin" ng-bind-html="getMessageForDataNotAvailable(selectedCampaign)"></div>


                    <div class="reports_details_outer_container" style="overflow:auto; width:1480px;">

                        <div class="clearfix reports_platform_header">
                            <margin-header></margin-header>
                        </div>
                        <div class="strategy_total_container ">
                            <div class="strategy_total_container_header clearfix">
                                <div class="each_col first_col" ng-hide="marginBusy">
                                    {{strategyHeading}}:
                                </div>
                                <div class="row_list_holder">
                                    <div class="common-load-icon" ng-show="marginBusy"></div>
                                    <div ng-show="!marginBusy"  class="clearfix each_row_list expandRow" ng-repeat="platform in platformData | orderBy:sortTypebyMargin:sortReverse  track by $index"  ng-include="'marginTpl'"></div>
                                </div>

                            </div>
                            <div class="all_strategies_holder" ng-show="!marginBusy">
                                <div class="each_strategy_holder clearfix" ng-repeat="platform in tacticPlatformData | orderBy:sortTypebyMargin:sortReverse track by $index" ng-if="platform.ad_id">
                                    <div class="linkage_bar"></div>
                                    <div class="each_strategy clearfix">
                                        <div class="each_col first_col">
                                            {{platform.ad_name}}
                                        </div>
                                        <div class="row_list_holder">
                                            <div class="clearfix each_row_list expandRow" ng-include="'marginTpl'"></div>

                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>


                </div>
                <!-- -------END :  Margin Block ----------------------------- -->
            </div>
        </div>
    </div>
</div>

<script type="text/ng-template" id="performanceTpl">
    <div class="platform_row">
        <div class="each_col sec_col platform_logo" ng-class="{vid_none_hdr:adFormats.videoAds == false,vid_show:adFormats.videoAds == true}">
            <span class="platform_logo_img">
                <img ng-src="{{platformIconUrl(platform.platform_name, platform.platform_icon_url)}}" />
            </span>
            <span class="plat_name" title="{{platform.platform_name}}">{{platform.platform_name}}</span>
        </div>
        <div class="each_col third_col">
            {{((platform.impressions >0)|| (platform.impressions == 0))? (platform.impressions | nrFormat) : '-'}}
        </div>

        <div class="vid_col" ng-show="adFormats.videoAds == true">
            <div class="each_col third_col">
                {{((platform.video_played >0)|| (platform.video_played == 0))? (platform.video_played | nrFormat) : '-'}}
            </div>

            <div class="vid_data_hdr">
                <div>
                    <div class="vid_quartile_data">{{((platform.video_completion_25 >0)|| (platform.video_completion_25 == 0))? (platform.video_completion_25 | nrFormat) : '-'}}</div>
                    <div class="vid_quartile_data">{{((platform.video_completion_50 >0)|| (platform.video_completion_50 == 0))? (platform.video_completion_50 | nrFormat) : '-'}}</div>
                    <div class="vid_quartile_data">{{((platform.video_completion_75 >0)|| (platform.video_completion_75 == 0))? (platform.video_completion_75 | nrFormat) : '-'}}</div>
                    <div class="vid_quartile_data">{{((platform.video_completion_100 >0)|| (platform.video_completion_100 == 0))? (platform.video_completion_100 | nrFormat) : '-'}}</div>
                </div>
            </div>
            <div class="each_col third_col">
                <span>{{((platform.vtc_100 >0)|| (platform.vtc_100 == 0)) ? ((platform.vtc_100 | number:2)+'%') : '-'}}</span>
            </div>
        </div>

        <div class="each_col forth_col">
            {{((platform.ctr >0)|| (platform.ctr == 0)) ? ((platform.ctr | number:2)+'%') : '-'}}
        </div>

        <div class="each_col fifth_col">
            {{((platform.action_rate >0)|| (platform.action_rate == 0)) ? ((platform.action_rate | number:2)+'%') : '-'}}
        </div>


    <span  ng-if="!adFormats.videoAds">
        <div class="each_col sixth_col">
            {{((platform.cpa >0)|| (platform.cpa == 0)) ? (platform.cpa | currency:undefined:2) : '-'}}
        </div>
        <div class="each_col seventh_col">
            {{((platform.cpc >0)|| (platform.cpc == 0)) ? (platform.cpc | currency:undefined:2) : '-'}}
        </div>
        <div class="each_col eight_col">
            {{((platform.cpm >0)|| (platform.cpm == 0)) ? (platform.cpm | currency:undefined:2) : '-'}}
        </div>
    </span>
        <div ng-if="adFormats.videoAds" class="each_col eight_col" ng-class="{vid_none:adFormats.videoAds == false}">
            <span ng-if="selected_filters.kpi_type=='ctr'||selected_filters.kpi_type=='vtc'||selected_filters.kpi_type=='action_rate'">{{((platform.cpm >0)|| (platform.cpm == 0)) ? (platform.cpm | currency:undefined:2) : '-'}}</span>
            <span ng-if="selected_filters.kpi_type=='cpm'||selected_filters.kpi_type=='cpc'||selected_filters.kpi_type=='cpa'">{{platform[selected_filters.kpi_type.toLowerCase()] | appendDollor:selected_filters2.kpi_type}}</span>
        </div>
    </div>
</script>

<script type="text/ng-template" id="videoViewabilityPartialTpl">
    <!--<div class="each_col ad_col">
        <div class="clearfix played_ad">
            <span class="specific_ad_icon"></span>
            <span class="ad_val">{{((platform.video_played >0)|| (platform.video_played == 0))? (platform.video_played | nrFormat) : '-'}}</span>
        </div>
        <div class="clearfix next_val viewed_ad">
            <span class="specific_ad_icon"></span>
            <span class="ad_val">{{((platform.video_viewable_impressions >0)|| (platform.video_viewable_impressions == 0))? (platform.video_viewable_impressions | nrFormat) : '-'}}</span>
        </div>
    </div>-->
    <div class="each_col sub_four_cols">
        <div class="sub_col">
            <span>{{((platform.vtc_25 >0)|| (platform.vtc_25 == 0)) ? ((platform.vtc_25 | number:0)+'%') : '-'}}</span>
            <span>{{((platform.vtc_50 >0)|| (platform.vtc_50 == 0)) ? ((platform.vtc_50 | number:0)+'%') : '-'}}</span>
            <span>{{((platform.vtc_75 >0)|| (platform.vtc_75 == 0)) ? ((platform.vtc_75 | number:0)+'%') : '-'}}</span>
            <span>{{((platform.vtc_100 >0)|| (platform.vtc_100 == 0)) ? ((platform.vtc_100 | number:0)+'%') : '-'}}</span>
        </div>
        <!--<div class="sub_col next_val">
            <span>{{vvData.videos_1q_view >0 ? (vvData.videos_1q_view | nrFormat) : '-'}}</span>
            <span>{{vvData.videos_2q_view >0 ? (vvData.videos_2q_view | nrFormat) : '-'}}</span>
            <span>{{vvData.videos_3q_view >0 ? (vvData.videos_3q_view | nrFormat) : '-'}}</span>
            <span>{{vvData.videos_4q_view >0 ? (vvData.videos_4q_view | nrFormat) : '-'}}</span>
        </div>-->
    </div>
    <!--<div class="each_col vtc_col">
        {{vvData.vtc | number:2}}%
    </div>-->
</script>


<script type="text/ng-template" id="videoViewabilityTpl">
    <div class="clearfix platform_row">
        <div class="each_col platform_name_col platform_logo" >
            <span class="platform_logo_img">
                <img ng-src="{{platformIconUrl(platform.platform_name, platform.platform_icon_url)}}" />
            </span>
            <span class="plat_name" title="{{platform.platform_name}}" >{{platform.platform_name}}</span>
        </div>

        <div class="each_col third_col impressions_col">
            <span>{{((platform.video_view_impressions >0)|| (platform.video_view_impressions == 0))? (platform.video_view_impressions | nrFormat) : '-'}}</span>
        </div>
        <div class="each_col third_col measurable_col" >
            <div class="sub_col">
                <span>{{((platform.video_view_measurable >0)|| (platform.video_view_measurable == 0))? (platform.video_view_measurable | nrFormat) : '-'}}</span>
                <span>{{((platform.video_view_measurable_perc >0)|| (platform.video_view_measurable_perc == 0)) ? ((platform.video_view_measurable_perc | number:0)+'%') : '-'}}</span>
            </div>
        </div>

        <div class="each_col forth_col">
            <div class="sub_col">
                <span> {{((platform.video_viewable_impressions >0)|| (platform.video_viewable_impressions == 0))? (platform.video_viewable_impressions | nrFormat) : '-'}}</span>
                <span> {{((platform.video_viewable_impressions_perc >0)|| (platform.video_viewable_impressions_perc == 0)) ? ((platform.video_viewable_impressions_perc | number:0)+'%') : '-'}}</span>
            </div>
        </div>

        <div class="clearfix pull-left" ng-include="'videoViewabilityPartialTpl'" ></div>

        <div class="each_col suspicious_col">
            {{((platform.video_view_imps_suspicious_perc >0)|| (platform.video_view_imps_suspicious_perc == 0)) ? ((platform.video_view_imps_suspicious_perc | number:2)+'%') : '-'}}
        </div>
    </div>
</script>

<script type="text/ng-template" id="costTpl">
    <div class="clearfix platform_row">
        <div class="each_cost_col first_col platform_logo" >
            <span class="platform_logo_img">
                <img ng-src="{{platformIconUrl(platform.platform_name, platform.platform_icon_url)}}" />
            </span>
            <span class="plat_name" title="{{platform.platform_name}}">{{platform.platform_name}}</span>
        </div>
        <div class="each_cost_col sec_col">{{((platform.impressions >0)|| (platform.impressions == 0))? (platform.impressions | nrFormat) : '-'}}</div>
        <div class="each_cost_col third_col">{{platform[selected_filters.kpi_type.toLowerCase()] | appendDollor : selected_filters.kpi_type.toLowerCase() }}</div>
        <div class="each_cost_col fourth_col">{{((platform.inventory_cost >0)|| (platform.inventory_cost == 0))? (platform.inventory_cost | currency:undefined:0) : '-'}}</div>
        <div class="each_cost_col fifth_col">{{((platform.data_cost >0)|| (platform.data_cost == 0))? (platform.data_cost | currency:undefined:0) : '-'}}</div>
        <div class="each_cost_col sixth_col">{{((platform.serving_cost >0)|| (platform.serving_cost == 0))? (platform.serving_cost | currency:undefined:0) : '-'}}</div>
        <div class="each_cost_col sev_col">{{((platform.verification_cost >0)|| (platform.verification_cost == 0))? (platform.verification_cost | currency:undefined:0) : '-'}}</div>
        <div class="each_cost_col eight_col total_cost">{{((platform.spend >0)|| (platform.spend == 0))? (platform.spend | currency:undefined:0) : '-'}}</div>
    </div>
</script>

<script type="text/ng-template" id="viewabilityTpl">
    <div class="clearfix platform_row">
        <div class="each_col platform_name_col platform_logo" >
            <span class="platform_logo_img">
                <img ng-src="{{platformIconUrl(platform.platform_name, platform.platform_icon_url)}}" />
            </span>
            <span class="plat_name" title="{{platform.platform_name}}" >{{platform.platform_name}}</span>
        </div>

        <div class="each_col third_col impressions_col">
            {{((platform.other_view_impressions >0)|| (platform.other_view_impressions == 0))? (platform.other_view_impressions | nrFormat) : '-'}}
        </div>
        <div class="each_col third_col measurable_col" >
            <div class="sub_col">
                <span> {{((platform.other_view_measurable >0)|| (platform.other_view_measurable == 0))? (platform.other_view_measurable | nrFormat) : '-'}}</span>
                <span>{{((platform.other_view_measurable_perc >0)|| (platform.other_view_measurable_perc == 0)) ? ((platform.other_view_measurable_perc | number:0)+'%') : '-'}}</span>
            </div>
        </div>
        <div class="each_col forth_col">
            <div class="sub_col">
                <span> {{((platform.other_viewable_impressions >0)|| (platform.other_viewable_impressions == 0))? (platform.other_viewable_impressions | nrFormat) : '-'}}</span>
                <span>{{((platform.other_viewable_impressions_perc >0)|| (platform.other_viewable_impressions_perc == 0)) ? ((platform.other_viewable_impressions_perc | number:0)+'%') : '-'}}</span>
            </div>
        </div>
        <div class="each_col suspicious_col">
            {{((platform.other_view_imps_suspicious_perc >0)|| (platform.other_view_imps_suspicious_perc == 0)) ? ((platform.other_view_imps_suspicious_perc | number:2)+'%') : '-'}}
        </div>
        <!-- <div class="each_col seventh_col">
             {{platform[selected_filters.kpi_type.toLowerCase()] | appendDollor: selected_filters.kpi_type}}
         </div>-->
    </div>
</script>



<script type="text/ng-template" id="marginTpl">
    <div class="clearfix platform_row">
        <div class="each_col platform_name_col platform_logo" >
            <span class="platform_logo_img">
                <img ng-src="{{platformIconUrl(platform.platform_name, platform.platform_icon_url)}}" />
            </span>
            <span class="plat_name" title="">{{platform.platform_name}}</span>
        </div>

       <div class="each_col second_coldata">
            <span class="icon_text_holder">{{platform.spend | nrFormat}}</span>
        </div>

      <div class="each_col third_coldata">
            <span class="icon_text_holder">{{platform.margin | number:2}}</span>
        </div>

         <div class="each_col forth_col" >
            <div class="sub_coldata">
                <span class="icon_text_holder">{{platform.CTR | number:2}}%</span>
                <span class="tooltip_holder icon_text_holder">{{platform.CPC | currency:undefined:2}}</span>
                <span class="tooltip_holder icon_text_holder">{{platform.clicks | nrFormat}}</span>
            </div>
        </div>

      <div class="each_col forth_col">
            <div class="sub_coldata">
                <span class="icon_text_holder">{{platform.VIEWABLE_IMPRESSIONS | number:2}}%</span>
                <span class="tooltip_holder icon_text_holder">{{platform.CPMv | currency:undefined:2}}</span>
                <span class="tooltip_holder icon_text_holder">{{platform.VIEWABLE_IMPS | nrFormat}}</span>
            </div>
        </div>
        <div class="each_col forth_col">
            <div class="sub_coldata">
                <span class="icon_text_holder">{{platform.AR | number:2}}%</span>
                <span class="tooltip_holder icon_text_holder">{{platform.CPA | currency:undefined:2}}</span>
                <span class="tooltip_holder icon_text_holder">{{platform.actions}}</span>
            </div>
        </div>
        <div class="each_col seventhMargin_col">
            <div class="sub_coldata">
                <span class="icon_text_holder">{{platform.impressions |  nrFormat}}</span>
                <span class="tooltip_holder icon_text_holder">{{platform.CPM | currency:undefined:2}}</span>
            </div>
        </div>
    </div>
</script>






















